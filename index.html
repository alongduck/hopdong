<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ª£p ƒê·ªìng T√¨nh Y√™u | Sushi & C√°</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS kh√¥ng thay ƒë·ªïi, gi·ªØ nguy√™n nh∆∞ c≈© */
        body {
            font-family: 'Times New Roman', Times, serif;
            background-color: #F0F2F5;
            color: #000;
            line-height: 1.8;
            margin: 0;
            padding: 30px;
            font-size: 16px;
        }
        .document-wrapper {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 60px 70px;
            box-shadow: 0 0 15px rgba(0,0,0,0.15);
            border: 1px solid #ccc;
            position: relative;
        }
        .national-header {
            margin-bottom: 20px;
            font-weight: bold;
            text-align: center;
        }
        .national-header .motto {
            text-transform: uppercase;
            margin: 0;
        }
        .national-header .independence {
            border-bottom: 1px solid #000;
            display: inline-block;
            padding-bottom: 2px;
            margin: 5px 0 0 0;
        }
        .contract-title {
            text-align: center;
            margin-top: 40px;
            margin-bottom: 40px;
        }
        .contract-title h1 {
            font-size: 24px;
            font-weight: bold;
            text-transform: uppercase;
            margin: 0;
        }
        .contract-title p {
            font-style: italic;
            margin-top: 5px;
        }
        .preamble { font-style: italic; margin-bottom: 20px; }
        .party-info { margin-bottom: 20px; }
        .party-info h3 { font-size: 18px; font-weight: bold; margin-bottom: 10px; }
        .party-info ul { list-style: none; padding-left: 15px; }
        .party-info li { margin-bottom: 5px; }
        .article { margin-bottom: 20px; }
        .article h3 { font-weight: bold; font-size: 18px; text-align: center; margin-bottom: 15px; }
        .article p, .article ol { margin-bottom: 10px; }
        .article ol { padding-left: 40px; }
        .article li { margin-bottom: 8px; }
        .signature-section {
            margin-top: 60px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            text-align: center;
            font-weight: bold;
            position: relative;
            z-index: 1;
        }
        .signature-area { padding-top: 10px; }
        .signature-area p { margin: 5px 0; }
        .signature-image-container {
            height: 80px;
            border-bottom: 1px solid #000;
            margin: 10px 20px 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .signature-image { max-width: 100%; max-height: 70px; }
        .sign-button {
            font-family: 'Times New Roman', Times, serif;
            background-color: #2c3e50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 14px;
        }
        .sign-button:hover { background-color: #34495e; }
        .official-seal-container {
            position: absolute;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%) rotate(-10deg);
            width: 160px;
            height: 160px;
            opacity: 0.85;
            z-index: 2;
            user-select: none;
            pointer-events: none;
        }
        .official-seal-container svg { width: 100%; height: 100%; color: #D32F2F; }
        .seal-text { font-family: 'Times New Roman', Times, serif; font-weight: bold; font-size: 22px; fill: currentColor; text-transform: uppercase; }
        .seal-star { font-size: 20px; font-weight: normal; }
        .signature-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0;
            width: 100%; height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 500px;
            border-radius: 8px;
            text-align: center;
        }
        #signature-canvas { border: 2px dashed #ccc; border-radius: 4px; cursor: crosshair; touch-action: none; }
        .modal-buttons { margin-top: 15px; }
        .modal-buttons button { font-family: 'Times New Roman', Times, serif; padding: 10px 20px; margin: 0 10px; border-radius: 4px; border: 1px solid #ccc; cursor: pointer; font-size: 16px; }
        #clear-button { background-color: #f1c40f; }
        #save-button { background-color: #2ecc71; color: white; }
        @media (max-width: 768px) {
            body { padding: 10px; }
            .document-wrapper { padding: 40px 25px; }
            .national-header, .signature-section { grid-template-columns: 1fr; gap: 20px; }
            .official-seal-container { bottom: 300px; width: 140px; height: 140px; }
            .signature-section .signature-area:first-child{ margin-bottom: 30px; }
        }
    </style>
</head>
<body>
    <!-- N·ªôi dung HTML c·ªßa h·ª£p ƒë·ªìng kh√¥ng thay ƒë·ªïi -->
    <div class="document-wrapper">
        <header class="national-header">
            <div>
                <p class="motto">C·ªòNG H√íA X√É H·ªòI CH·ª¶ NGHƒ®A VI·ªÜT NAM</p>
                <p class="independence">ƒê·ªôc l·∫≠p - T·ª± do - H·∫°nh ph√∫c</p>
            </div>
        </header>

        <section class="contract-title">
            <h1>H·ª¢P ƒê·ªíNG T√åNH Y√äU</h1>
            <p>(S·ªë: 0408/2025/HƒêTY-SC)</p>
        </section>

        <p class="preamble">
            - CƒÉn c·ª© v√†o B·ªô lu·∫≠t T√¨nh y√™u v√† H·∫°nh ph√∫c ƒë∆∞·ª£c tr√°i tim th√¥ng qua.<br>
            - CƒÉn c·ª© v√†o s·ª± t·ª± nguy·ªán, th·∫•u hi·ªÉu v√† t√¨nh c·∫£m ch√¢n th√†nh c·ªßa c·∫£ hai b√™n.
        </p>

        <p>H√¥m nay, ng√†y 04 th√°ng 08 nƒÉm 2025, t·∫°i m·ªôt n∆°i ch·ªâ c√≥ hai ch√∫ng ta, ch√∫ng t√¥i g·ªìm:</p>

        <section class="party-info">
            <h3>B√äN A: (Sau ƒë√¢y g·ªçi l√† "Sushi" üç£)</h3>
            <ul>
                <li><strong>H·ªç v√† t√™n:</strong> L∆∞∆°ng L√™ V√¢n Nam</li>
                <li><strong>Ng√†y sinh:</strong> 19/01/2006</li>
                <li><strong>N∆°i ·ªü hi·ªán t·∫°i:</strong> Di·ªÖn Ch√¢u, Ngh·ªá An</li>
            </ul>
        </section>

        <section class="party-info">
            <h3>B√äN B: (Sau ƒë√¢y g·ªçi l√† "C√°" üê†)</h3>
            <ul>
                <li><strong>H·ªç v√† t√™n:</strong> Nguy·ªÖn B·∫£o Tr√≠</li>
                <li><strong>Ng√†y sinh:</strong> 12/05/2002</li>
                <li><strong>N∆°i ·ªü hi·ªán t·∫°i:</strong> TP. H·ªì Ch√≠ Minh</li>
            </ul>
        </section>

        <p>Sau khi b√†n b·∫°c, hai b√™n ƒë√£ th·ªëng nh·∫•t k√Ω k·∫øt H·ª£p ƒë·ªìng T√¨nh y√™u v·ªõi c√°c ƒëi·ªÅu kho·∫£n v√† ƒëi·ªÅu ki·ªán nh∆∞ sau:</p>

        <article class="article">
            <h3>ƒêi·ªÅu 1: Quy·ªÅn v√† Nghƒ©a v·ª• c·ªßa B√™n A</h3>
            <ol>
                <li>Lu√¥n duy tr√¨ s·ª± d·ªÖ th∆∞∆°ng, trung th·ª±c; nghi√™m c·∫•m h√†nh vi ghen tu√¥ng v√¥ cƒÉn c·ª© g√¢y ·∫£nh h∆∞·ªüng ƒë·∫øn h√≤a kh√≠ chung.</li>
                <li>ƒê∆∞·ª£c th·ª±c thi "quy·ªÅn gi·∫≠n d·ªói", tuy nhi√™n ph·∫£i th√¥ng b√°o tr∆∞·ªõc cho B√™n B ƒë·ªÉ c√≥ ph∆∞∆°ng √°n x·ª≠ l√Ω k·ªãp th·ªùi.</li>
                <li>C√≥ nghƒ©a v·ª• b√°o c√°o, chia s·∫ª m·ªçi c·∫£m x√∫c, t√¢m t∆∞ v·ªõi B√™n B.</li>
                <li>ƒê∆∞·ª£c y√™u c·∫ßu B√™n B th·ª±c hi·ªán c√°c h√†nh vi chƒÉm s√≥c nh∆∞ √¥m, h√¥n, ho·∫∑c cung c·∫•p l∆∞∆°ng th·ª±c (ƒë·ªì ƒÉn v·∫∑t) v√†o b·∫•t k·ª≥ th·ªùi ƒëi·ªÉm n√†o.</li>
            </ol>
        </article>

        <article class="article">
            <h3>ƒêi·ªÅu 2: Quy·ªÅn v√† Nghƒ©a v·ª• c·ªßa B√™n B</h3>
            <ol>
                <li>C√≥ nghƒ©a v·ª• b·∫£o v·ªá, che ch·ªü v√† l√† ng∆∞·ªùi ch·ªß ƒë·ªông th·ª±c hi·ªán h√≤a gi·∫£i khi c√≥ tranh ch·∫•p, m√¢u thu·∫´n x·∫£y ra.</li>
                <li>Ph·∫£i ph·∫£n h·ªìi th√¥ng ƒëi·ªáp c·ªßa B√™n A trong th·ªùi h·∫°n 02 (hai) gi·ªù, tr·ª´ c√°c tr∆∞·ªùng h·ª£p b·∫•t kh·∫£ kh√°ng (ng·ªß, h·ªçp kh·∫©n, v.v.).</li>
                <li>Khi B√™n A th·ª±c thi "quy·ªÅn gi·∫≠n d·ªói", B√™n B ph·∫£i c√≥ bi·ªán ph√°p d·ªó d√†nh ngay l·∫≠p t·ª©c b·∫±ng h√†nh ƒë·ªông ho·∫∑c l·ªùi n√≥i ph√π h·ª£p.</li>
                <li>Cam k·∫øt trung th√†nh tuy·ªát ƒë·ªëi, kh√¥ng c√≥ b·∫•t k·ª≥ h√†nh vi t∆∞∆°ng t√°c (th·∫£ tim, b√¨nh lu·∫≠n) v·ªõi c√°c ƒë·ªëi t∆∞·ª£ng kh√°c gi·ªõi c√≥ kh·∫£ nƒÉng g√¢y hi·ªÉu l·∫ßm.</li>
            </ol>
        </article>

        <article class="article">
            <h3>ƒêi·ªÅu 3: ƒêi·ªÅu Kho·∫£n Thi H√†nh Chung</h3>
            <ol>
                <li>Hai b√™n ph·∫£i t·ªï ch·ª©c √≠t nh·∫•t 01 (m·ªôt) bu·ªïi h·∫πn h√≤ m·ªói th√°ng.</li>
                <li>Th·ª±c hi·ªán ƒë·∫ßy ƒë·ªß nghi th·ª©c ch√∫c ng·ªß ngon v√† ch√∫c ng√†y m·ªõi t·ªët l√†nh h√†ng ng√†y.</li>
                <li>Khi m·ªôt b√™n c√≥ d·∫•u hi·ªáu b·∫•t ·ªïn v·ªÅ tinh th·∫ßn (bu·ªìn), b√™n c√≤n l·∫°i ph·∫£i c√≥ tr√°ch nhi·ªám l·∫Øng nghe v√† an ·ªßi.</li>
                <li>Nghi√™m c·∫•m s·ª± can thi·ªáp c·ªßa b√™n th·ª© ba v√†o m·ªëi quan h·ªá h·ª£p ƒë·ªìng n√†y.</li>
            </ol>
        </article>
        
        <article class="article">
            <h3>ƒêi·ªÅu 4: X·ª≠ L√Ω Vi Ph·∫°m</h3>
            <p>B√™n n√†o vi ph·∫°m m·ªôt trong c√°c ƒëi·ªÅu kho·∫£n tr√™n s·∫Ω b·ªã x·ª≠ ph·∫°t theo c√°c h√¨nh th·ª©c sau (do b√™n b·ªã vi ph·∫°m quy·∫øt ƒë·ªãnh):</p>
            <ol type="a">
                <li>So·∫°n th·∫£o vƒÉn b·∫£n xin l·ªói (th∆∞ tay) v·ªõi ƒë·ªô d√†i t·ªëi thi·ªÉu 500 t·ª´.</li>
                <li>B·ªìi th∆∞·ªùng thi·ªát h·∫°i b·∫±ng hi·ªán v·∫≠t (tr√† s·ªØa, ƒë·ªì ƒÉn v·∫∑t).</li>
                <li>Th·ª±c hi·ªán m·ªôt ti·∫øt m·ª•c vƒÉn ngh·ªá (h√°t) ƒë·ªÉ chu·ªôc l·ªói.</li>
            </ol>
        </article>

        <article class="article">
            <h3>ƒêi·ªÅu 5: Hi·ªáu L·ª±c H·ª£p ƒê·ªìng</h3>
            <p>H·ª£p ƒë·ªìng n√†y c√≥ hi·ªáu l·ª±c k·ªÉ t·ª´ ng√†y k√Ω v√† c√≥ gi√° tr·ªã v√¥ th·ªùi h·∫°n. M·ªçi s·ª≠a ƒë·ªïi, b·ªï sung ph·∫£i ƒë∆∞·ª£c s·ª± ƒë·ªìng √Ω b·∫±ng vƒÉn b·∫£n c·ªßa c·∫£ hai b√™n.</p>
        </article>

        <footer class="signature-section">
            <div class="signature-area">
                <p>ƒê·∫†I DI·ªÜN B√äN A</p>
                <i>(K√Ω v√† ghi r√µ h·ªç t√™n)</i>
                <div class="signature-image-container">
                    <img id="signature-image-A" class="signature-image" src="" alt="Ch·ªØ k√Ω B√™n A">
                </div>
                <p>L∆∞∆°ng L√™ V√¢n Nam</p>
                <button class="sign-button" data-party="A">K√Ω t√™n</button>
            </div>
            <div class="signature-area">
                <p>ƒê·∫†I DI·ªÜN B√äN B</p>
                <i>(K√Ω v√† ghi r√µ h·ªç t√™n)</i>
                <div class="signature-image-container">
                     <img id="signature-image-B" class="signature-image" src="" alt="Ch·ªØ k√Ω B√™n B">
                </div>
                <p>Nguy·ªÖn B·∫£o Tr√≠</p>
                 <button class="sign-button" data-party="B">K√Ω t√™n</button>
            </div>
        </footer>

        <!-- === CON D·∫§U ƒê√É ƒê∆Ø·ª¢C CH√àN V√ÄO === -->
        <div class="official-seal-container">
           
      
                <image href="https://d5.violet.vn/uploads/extras/document/1/343/599/HINH_80_QUOC_HUY.jpg.jpg" x="55" y="55" width="90" height="90"/>
        
        </div>
    </div>

    <!-- === C·ª¨A S·ªî K√ù T√äN ƒêI·ªÜN T·ª¨ === -->
    <div id="signature-modal" class="signature-modal">
        <div class="modal-content">
            <h3>Vui l√≤ng k√Ω t√™n v√†o khung b√™n d∆∞·ªõi</h3>
            <canvas id="signature-canvas"></canvas>
            <div class="modal-buttons">
                <button id="clear-button">X√≥a</button>
                <button id="save-button">L∆∞u ch·ªØ k√Ω</button>
            </div>
        </div>
    </div>

    <!-- === PH·∫¶N SCRIPT M·ªöI - T√çCH H·ª¢P FIREBASE === -->
    <!-- Import c√°c th∆∞ vi·ªán Firebase -->
    <script type="module">
        // Import c√°c h√†m c·∫ßn thi·∫øt t·ª´ Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        // ==================================================================
        // == QUAN TR·ªåNG: D√ÅN C·∫§U H√åNH FIREBASE C·ª¶A B·∫†N V√ÄO ƒê√ÇY           ==
        // ==================================================================
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
  apiKey: "AIzaSyAbUyJKiNX_mKhZAHNYW9FiafNi7H2OdaQ",
  authDomain: "dbhopdong.firebaseapp.com",
  projectId: "dbhopdong",
  storageBucket: "dbhopdong.appspot.com", // <-- ƒê√É S·ª¨A L·ªñI ·ªû ƒê√ÇY
  messagingSenderId: "231501377480",
  appId: "1:231501377480:web:65d49e3266fc4504bb5afd",
  measurementId: "G-97VM4FS9Z5"
};
        // ==================================================================

        // Kh·ªüi t·∫°o Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ƒê·ªãnh danh duy nh·∫•t cho h·ª£p ƒë·ªìng n√†y trong database
        const contractId = "hop-dong-sushi-ca";
        const contractRef = doc(db, "contracts", contractId);

        // H√†m t·∫£i ch·ªØ k√Ω t·ª´ database khi m·ªü trang
        async function loadSignatures() {
            try {
                const docSnap = await getDoc(contractRef);
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if (data.signatureA) {
                        document.getElementById('signature-image-A').src = data.signatureA;
                    }
                    if (data.signatureB) {
                        document.getElementById('signature-image-B').src = data.signatureB;
                    }
                } else {
                    console.log("Ch∆∞a c√≥ ch·ªØ k√Ω n√†o ƒë∆∞·ª£c l∆∞u.");
                }
            } catch (error) {
                console.error("L·ªói khi t·∫£i ch·ªØ k√Ω: ", error);
                alert("Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn c∆° s·ªü d·ªØ li·ªáu. H√£y ki·ªÉm tra l·∫°i c·∫•u h√¨nh Firebase c·ªßa b·∫°n trong file index.html.");
            }
        }

        // H√†m l∆∞u ch·ªØ k√Ω v√†o database
        async function saveSignatureToDB(party, signatureDataUrl) {
            try {
                const dataToSave = {};
                if (party === 'A') {
                    dataToSave.signatureA = signatureDataUrl;
                } else {
                    dataToSave.signatureB = signatureDataUrl;
                }
                // D√πng { merge: true } ƒë·ªÉ kh√¥ng ghi ƒë√® ch·ªØ k√Ω c·ªßa ng∆∞·ªùi c√≤n l·∫°i
                await setDoc(contractRef, dataToSave, { merge: true });
                console.log("ƒê√£ l∆∞u ch·ªØ k√Ω c·ªßa b√™n", party);
            } catch (error) {
                console.error("L·ªói khi l∆∞u ch·ªØ k√Ω: ", error);
                alert("L∆∞u ch·ªØ k√Ω th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i.");
            }
        }

        // --- Ph·∫ßn code x·ª≠ l√Ω b·∫£ng v·∫Ω (gi·ªØ nguy√™n) ---
        const modal = document.getElementById('signature-modal');
        const canvas = document.getElementById('signature-canvas');
        const ctx = canvas.getContext('2d');
        const signButtons = document.querySelectorAll('.sign-button');
        const clearButton = document.getElementById('clear-button');
        const saveButton = document.getElementById('save-button');

        let drawing = false;
        let lastX = 0;
        let lastY = 0;
        let currentParty = '';

        function resizeCanvas() {
            const ratio = Math.max(window.devicePixelRatio || 1, 1);
            const modalContent = document.querySelector('.modal-content');
            canvas.width = modalContent.clientWidth * 0.9 * ratio;
            canvas.height = 200 * ratio;
            canvas.style.width = `${modalContent.clientWidth * 0.9}px`;
            canvas.style.height = '200px';
            ctx.scale(ratio, ratio);
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
        }

        function startDrawing(e) {
            drawing = true;
            [lastX, lastY] = getCoords(e);
        }

        function stopDrawing() {
            drawing = false;
            ctx.beginPath();
        }

        function draw(e) {
            if (!drawing) return;
            e.preventDefault();
            const [x, y] = getCoords(e);
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(x, y);
            ctx.stroke();
            [lastX, lastY] = [x, y];
        }

        function getCoords(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / (rect.width * window.devicePixelRatio);
            const scaleY = canvas.height / (rect.height * window.devicePixelRatio);
            if (e.touches && e.touches.length > 0) {
                return [(e.touches[0].clientX - rect.left) * scaleX, (e.touches[0].clientY - rect.top) * scaleY];
            }
            return [(e.clientX - rect.left) * scaleX, (e.clientY - rect.top) * scaleY];
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        signButtons.forEach(button => {
            button.addEventListener('click', () => {
                currentParty = button.getAttribute('data-party');
                modal.style.display = 'flex';
                resizeCanvas();
                clearCanvas();
            });
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });

        // S·ª¨A L·∫†I N√öT L∆ØU: Th√™m h√†m g·ªçi ƒë·∫øn database
        saveButton.addEventListener('click', () => {
             // Ki·ªÉm tra xem canvas c√≥ tr·ªëng kh√¥ng
            const blankCanvas = document.createElement('canvas');
            blankCanvas.width = canvas.width;
            blankCanvas.height = canvas.height;
            if (canvas.toDataURL() === blankCanvas.toDataURL()) {
                alert("B·∫°n ch∆∞a k√Ω t√™n!");
                return;
            }

            const signatureDataUrl = canvas.toDataURL('image/png');
            const signatureImage = document.getElementById(`signature-image-${currentParty}`);
            signatureImage.src = signatureDataUrl;

            // G·ªçi h√†m ƒë·ªÉ l∆∞u v√†o Firebase
            saveSignatureToDB(currentParty, signatureDataUrl);

            modal.style.display = 'none';
        });

        clearButton.addEventListener('click', clearCanvas);

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchend', stopDrawing);
        canvas.addEventListener('touchcancel', stopDrawing);
        canvas.addEventListener('touchmove', draw);
        window.addEventListener('resize', resizeCanvas);

        // T·∫£i ch·ªØ k√Ω ƒë√£ l∆∞u khi trang ƒë∆∞·ª£c m·ªü
        window.onload = loadSignatures;

    </script>
</body>
</html>
